repositories:
  default-repository: &default-repository
    repo: "/srv/restic/repository"
    password-file: "/run/secrets/password"

commands:
  backup:
    arguments:
      - backup
      - /source
    flags:
      <<: *default-repository
      keep-daily: 1
      keep-weekly: 2
      keep-monthly: 3
      keep-yearly: 4
      group-by: paths
      prune: true
      exclude:
        - *.secret
        - *.bin
    hooks:
      pre: "echo 'exec containers & stop containers...'"
      post: "echo 'start containers ...'"
      success: ""
      failure: ""
